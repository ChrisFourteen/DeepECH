# DeepECH: 全球电子回旋谐波 (ECH) 波两阶段深度学习预测模型

## 项目简介

本模型基于 Van Allen Probes (2013-2018) 的实测数据开发，旨在实现地球磁层中 **电子回旋谐波 (ECH) 波** 发生及其强度的全球动态预测。

ECH 波是磁层动力学中的关键要素，通过散射高能电子导致电子沉降进入高层大气，进而产生弥散极光。本模型利用多分辨率地磁指数（SYM-H, SME）和空间位置参数，能够可靠地捕捉磁暴期间 ECH 波活动的增强与空间扩张。

## 核心研究背景 (参考论文)

- **两阶段预测架构**: 模型首先通过分类网络判断 ECH 波是否存在（测试集准确率 91.2%），若存在则调用回归网络预测其振幅（测试集 $R^2$ 0.7094）。
- **多分辨率特征提取**: 结合了 1 小时和 1 分钟分辨率的地磁指数序列（SYM-H_48H, SME_48H, SYM-H_60M, SME_60M），利用带注意力机制的 LSTM (Attention-LSTM) 提取时间演化特征。
- **空间位置建模**: 综合考虑 L-shell、磁地方时 (MLT) 及磁纬 (MLAT) 的非线性影响。
- **科学意义**: 相比传统的统计模型，本模型能够提供瞬时的、全球分布的波幅预测，为磁层动力学的动态模拟提供精确输入。

## 模型架构

1. **分类模型 (`transpace_cls.py`)**: 判断特定时空条件下 ECH 波的发生概率。
2. **回归模型 (`transpace.py`)**: 在波发生的前提下，精确计算波的振幅 (dB)。
3. **推理脚本 (`run_inference.py`)**: 整合两阶段逻辑，生成全球 L-MLT 网格的分布图。

## 快速开始

### 环境依赖
请确保安装了以下依赖（详见 `requirements.txt`）：
```bash
pip install -r requirements.txt
```

### 运行推理
执行以下脚本即可加载预训练模型并生成示例网格数据：
```bash
python run_inference.py
```
推理结果将保存于 `results/` 目录下，包含：
- `regression_grid.mat`: 全球 ECH 波振幅分布。
- `classification_grid.mat`: ECH 波发生概率分布。

## 数据说明
- `checkpoints/`: 存放预训练的模型权重文件。
- `data/`: 包含用于推理测试的样本特征向量（Pickle 格式）。
- `results/`: 输出的 `.mat` 文件可直接用于 MATLAB 绘图分析。


